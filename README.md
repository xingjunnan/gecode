# 将地理位置批量转换成经纬度
项目主要功能：通过上传带有地理位置的excel,利用百度地图API将地理位置数据批量转换成经纬度（也可使用其他公司API）。支持大批量数据高并发处理(160QPS以上)，系统页面展示数据处理的实时进度，数据处理完成后会导出带有经纬度数据列的excel，并通知文件大小、各个环节处理的时长、处理成功和失败的个数等信息。可根据不同的excel、API密钥、网络速度等情况，通过设置功能自定义excel的列数、地理位置数据列名称、sheet名称、文件导出路径、处理的线程数量、百度地图AK进行动态配置。项目启动后将自动打开并使用默认浏览器，该项目可兼容市面上所有常用的浏览器(IE浏览器导出文件路径与导入路径一致)。

项目技术详情：该项目前端框架使用layUI，后台框架使用springboot，使用thymeleaf作为模板引擎，由于该项目不需要使用数据库，所以可以使用exe4j和inno setup将项目微服务和jre打包封装成Windows本地应用。该项目内继承了SpringBoot的ApplicationRunner并重写了run方法，使项目启动后打开默认浏览器并访问项目的页面。项目的server.address配置为127.0.0.1,所以只能本地进行访问该服务。该项目是针对大数据量处理设计的，但由于POI在处理大数据excel时会出现内存溢出的问题，所以通过使用CVS模式解决XLSX文件，有效解决用户模式内存溢出的问题。该模式是POI官方推荐的读取大数据的模式，在用户模式下，数据量较大、Sheet较多、或者是有很多无用的空行的情况。经过处理excel获取到地理位置数据后，通过httpClient对百度API进行访问得到经纬度信息，在处理的过程中访问远程API的时间占比较大，所以通过多线程的方式提高了处理的速度。又通过使用WebSocket将后台微服务的处理情况实时推送到前端页面，在遇到excel解析失败，API访问异常等情况时对异常情况做出判断，向前端页面反馈异常的原因并停止数据的处理。项目中通过读取修改项目的properties文件对配置进行动态修改，但在这过程中读取properties文件中的中文会出现乱码。这是由于springboot2.0后org.springframework.boot.env.OriginTrackedPropertiesLoader文件加载配置文件时编码格式硬编码为了ISO-8859-1，所以需要项目本地重构OriginTrackedPropertiesLoader文件将编码改为UTF-8。在数据的处理前后记录了数据的大小、数据的处理时间、处理成功和失败的个数，在处理完成后将文件大小和数据处理的时间格式化后展示到前端页面。导出成功后使用RunTime.getRuntime().exec()调用命令，打开导出文件的所在位置(由于IE浏览器可以获取到导入时的全路径，所以我将导入导出路径保持了一致，其他浏览器导出路径为设置功能中配置的文件路径)。
